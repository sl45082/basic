<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>OBX lwwa v0.1</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }
    #image-viewer {
      position: fixed;
      top: 50%;
      left: 50%;
      height: 100vh;
      width: 100vw;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
      transform: translate(-50%, -50%) scale(1);
      transition: transform 0.5s ease;
    }
    audio {
      display: none;
    }
  </style>
</head>
<body>
  <div id="image-viewer"></div>
  <audio id="noaa-rock" src="https://sl45082.github.io/basic/wa/pw/noaa-rock.mp3" preload="none" autoplay></audio>

  <button id="start-btn" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
    padding: 1em 2em; font-size: 1.2em;">Start Weather</button>

  <script>
    const baseUrl = 'https://sl45082.github.io/basic/wa/pw/';
    const images = [
      { filename: 'camtile.gif', zoom: 100 },
      { filename: 'accuweather.png', zoom: 100 },
      { filename: 'tides.png', zoom: 100 },
      { filename: 'ikite.png', zoom: 100 },
      { filename: 'noaa.png', zoom: 100},
      { filename: 'surfchex1.png',  zoom: 170},
      { filename: 'captain.png', zoom: 100 },
      { filename: 'surfchex2.png',  zoom: 140},
      { filename: 'surf-temp.gif', zoom: 120},
      { filename: 'cones.png', zoom: 90},
      { filename: '7day.png',  zoom: 95},
      { filename: 'floodzone.jpg',  zoom: 95}
    ];
//
    let index = 0;
    const viewer = document.getElementById('image-viewer');
    const radio = document.getElementById('radio');

    // function to iterate through images
    function showNextImage() {
      const viewer = document.getElementById('image-viewer');
      const current = images[index];

      // querystring to bust cache
      const timestamp = new Date().getTime();
      const img = new Image();
      qscb = `?v=${timestamp}`;

      viewer.style.backgroundImage = `url(${baseUrl + current.filename + qscb})`;

      // Apply zoom level (convert percent to scale factor)
      const scale = current.zoom / 100;
      viewer.style.transform = `translate(-50%, -50%) scale(${scale})`;

      // advance to next image
      index = (index + 1) % images.length;

      //schedule next image	
      setTimeout(showNextImage, 25000); // Wait x seconds before showing next image
    }

    // function to play noaa radio
    function playWeatherRadio() {

      const noaaRadio = document.getElementById('noaa-rock');

     // Start weather stream
     noaaRadio.play().catch(err => console.warn("noaa stream failed:", err));

     // loop audio 

    }

    // Kick it off
    document.getElementById('start-btn').onclick = () => {
        document.getElementById('start-btn').remove();
        showNextImage();
        playWeatherRadio(); // Initial broadcast
        setInterval(playWeatherRadio, 9 * 60 * 1000); // Repeat every 8  min
    };

  </script>
</body>
</html>


